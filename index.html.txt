<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CleanMaster 2D</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background: #f0f8ff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
            overflow: hidden;
        }
        
        .game-container {
            position: relative;
            width: 800px;
            height: 600px;
            background: url('/api/placeholder/800/600') center center;
            background-size: cover;
            border: 4px solid #333;
            overflow: hidden;
        }
        
        .dirt {
            position: absolute;
            border-radius: 50%;
            background-color: #8B4513;
            cursor: pointer;
        }
        
        .dirt.grease {
            background-color: rgba(100, 100, 100, 0.8);
        }
        
        .dirt.dust {
            background-color: rgba(200, 180, 140, 0.8);
        }
        
        .dirt.grime {
            background-color: rgba(50, 60, 40, 0.9);
        }
        
        .tools {
            display: flex;
            margin-top: 20px;
            gap: 20px;
        }
        
        .tool {
            padding: 10px 20px;
            background: #4b93d1;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .tool:hover {
            background: #3a75a9;
            transform: scale(1.05);
        }
        
        .tool.active {
            background: #2c5880;
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }
        
        .score-container {
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
        }
        
        .progress-bar {
            width: 800px;
            height: 20px;
            border: 2px solid #333;
            border-radius: 10px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, #4CAF50, #8BC34A);
            width: 0%;
            transition: width 0.5s;
        }
        
        .particle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
        }
        
        .instructions {
            margin-top: 20px;
            text-align: center;
            max-width: 800px;
        }
    </style>
</head>
<body>
    <h1>CleanMaster 2D</h1>
    <div class="game-container" id="gameContainer"></div>
    <div class="tools">
        <button class="tool" id="waterTool">1. Water</button>
        <button class="tool" id="detergentTool">2. Detergent</button>
        <button class="tool" id="afterwashTool">3. After Wash</button>
    </div>
    <div class="score-container">
        Cleanliness: <span id="score">0</span>%
        <div class="progress-bar">
            <div class="progress" id="progressBar"></div>
        </div>
    </div>
    <div class="instructions">
        <p><strong>Instructions:</strong> Click on dirt spots to clean them. Different types of dirt require different cleaning methods:</p>
        <p>Dust (tan) - Water | Grease (gray) - Detergent + Water | Grime (dark green) - Detergent + Water + After Wash</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Game elements
            const gameContainer = document.getElementById('gameContainer');
            const waterTool = document.getElementById('waterTool');
            const detergentTool = document.getElementById('detergentTool');
            const afterwashTool = document.getElementById('afterwashTool');
            const scoreElement = document.getElementById('score');
            const progressBar = document.getElementById('progressBar');
            
            // Game state
            let score = 0;
            let totalDirt = 0;
            let currentTool = 'water';
            let treatmentSteps = {};
            
            // Set active tool
            function setActiveTool(tool) {
                waterTool.classList.remove('active');
                detergentTool.classList.remove('active');
                afterwashTool.classList.remove('active');
                
                currentTool = tool;
                
                if (tool === 'water') {
                    waterTool.classList.add('active');
                } else if (tool === 'detergent') {
                    detergentTool.classList.add('active');
                } else if (tool === 'afterwash') {
                    afterwashTool.classList.add('active');
                }
            }
            
            // Generate random dirt
            function generateDirt(count) {
                const dirtTypes = ['dust', 'grease', 'grime'];
                
                for (let i = 0; i < count; i++) {
                    const size = Math.floor(Math.random() * 40) + 30;
                    const x = Math.floor(Math.random() * (gameContainer.offsetWidth - size));
                    const y = Math.floor(Math.random() * (gameContainer.offsetHeight - size));
                    const type = dirtTypes[Math.floor(Math.random() * dirtTypes.length)];
                    
                    const dirt = document.createElement('div');
                    dirt.className = `dirt ${type}`;
                    dirt.style.width = `${size}px`;
                    dirt.style.height = `${size}px`;
                    dirt.style.left = `${x}px`;
                    dirt.style.top = `${y}px`;
                    dirt.dataset.type = type;
                    dirt.dataset.id = `dirt-${i}`;
                    
                    gameContainer.appendChild(dirt);
                    
                    // Initialize treatment steps for this dirt
                    treatmentSteps[`dirt-${i}`] = {
                        water: false,
                        detergent: false,
                        afterwash: false
                    };
                    
                    // Add click event
                    dirt.addEventListener('click', function(e) {
                        handleDirtClick(e.target);
                    });
                    
                    totalDirt++;
                }
            }
            
            // Create particles
            function createParticles(x, y, color, count) {
                for (let i = 0; i < count; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.width = `${Math.random() * 8 + 2}px`;
                    particle.style.height = particle.style.width;
                    particle.style.backgroundColor = color;
                    particle.style.left = `${x}px`;
                    particle.style.top = `${y}px`;
                    
                    // Random velocity
                    const vx = (Math.random() - 0.5) * 10;
                    const vy = (Math.random() - 0.5) * 10;
                    
                    gameContainer.appendChild(particle);
                    
                    // Animate particle
                    let opacity = 1;
                    const animateParticle = () => {
                        const currentLeft = parseFloat(particle.style.left);
                        const currentTop = parseFloat(particle.style.top);
                        
                        particle.style.left = `${currentLeft + vx}px`;
                        particle.style.top = `${currentTop + vy}px`;
                        
                        opacity -= 0.05;
                        particle.style.opacity = opacity;
                        
                        if (opacity > 0) {
                            requestAnimationFrame(animateParticle);
                        } else {
                            particle.remove();
                        }
                    };
                    
                    requestAnimationFrame(animateParticle);
                }
            }
            
            // Handle dirt cleaning
            function handleDirtClick(dirtElement) {
                const dirtType = dirtElement.dataset.type;
                const dirtId = dirtElement.dataset.id;
                
                const particleX = parseFloat(dirtElement.style.left) + parseFloat(dirtElement.style.width) / 2;
                const particleY = parseFloat(dirtElement.style.top) + parseFloat(dirtElement.style.height) / 2;
                
                // Apply current tool
                if (currentTool === 'water') {
                    treatmentSteps[dirtId].water = true;
                    createParticles(particleX, particleY, '#87CEFA', 20); // Light blue particles
                } else if (currentTool === 'detergent') {
                    treatmentSteps[dirtId].detergent = true;
                    createParticles(particleX, particleY, '#FFA500', 20); // Orange particles
                } else if (currentTool === 'afterwash') {
                    treatmentSteps[dirtId].afterwash = true;
                    createParticles(particleX, particleY, '#9370DB', 20); // Purple particles
                }
                
                // Check if dirt is clean based on treatment sequence
                let isClean = false;
                
                if (dirtType === 'dust' && treatmentSteps[dirtId].water) {
                    isClean = true;
                } else if (dirtType === 'grease' && treatmentSteps[dirtId].detergent && treatmentSteps[dirtId].water) {
                    isClean = true;
                } else if (dirtType === 'grime' && treatmentSteps[dirtId].detergent && treatmentSteps[dirtId].water && treatmentSteps[dirtId].afterwash) {
                    isClean = true;
                }
                
                if (isClean && dirtElement.parentNode === gameContainer) {
                    // Create explosion effect
                    createParticles(particleX, particleY, '#FFFFFF', 30);
                    
                    // Remove dirt
                    dirtElement.remove();
                    
                    // Update score
                    updateScore();
                }
            }
            
            // Update score
            function updateScore() {
                const cleanedDirt = totalDirt - document.querySelectorAll('.dirt').length;
                score = Math.round((cleanedDirt / totalDirt) * 100);
                
                scoreElement.textContent = score;
                progressBar.style.width = `${score}%`;
                
                if (score === 100) {
                    setTimeout(() => {
                        alert('Congratulations! You cleaned everything!');
                    }, 500);
                }
            }
            
            // Tool selection events
            waterTool.addEventListener('click', function() {
                setActiveTool('water');
            });
            
            detergentTool.addEventListener('click', function() {
                setActiveTool('detergent');
            });
            
            afterwashTool.addEventListener('click', function() {
                setActiveTool('afterwash');
            });
            
            // Initialize game
            setActiveTool('water');
            generateDirt(15);
        });
    </script>
</body>
</html>